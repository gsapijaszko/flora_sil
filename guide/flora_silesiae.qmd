---
title: "Flora Silesiae"
author: "Grzegorz Sapijaszko"
format: 
  html:
    toc: true
  gfm: 
    toc: false
---

## Flora Silesiae

Historical data on the flora of Silesia based on articles published by 'Botanische Sektion` in *Jahres-Bericht der Schlesischen Gesellschaft für vaterländische Cultur*. Electronic versions of the reports can be found at [Opole Digital Library](https://www.obc.opole.pl/dlibra/publication/8613#structure) and [Silesia Digital Library](https://www.sbc.org.pl/dlibra/publication/11059#structure)

### How to use

The full dataset is saved into `flora_sil.Rds` file. You can read it using:

```{r}
#| echo: false
#| 
jahres <- readRDS(file = "../data/flora_sil.Rds")
```

```{r}
#| eval: false
#| 
jahres <- readRDS(file = "data/flora_sil.Rds")
```

Let's have a look on `jahres` data frame:

:::{.column-page}
```{r}

jahres |>
  dplyr::slice_sample(n = 2) |>
  knitr::kable()
```
:::

Having pair of geographical coordinates -- `lon[gitude]` and `lat[itude]` -- it's very easy to convert the data frame to simple feature df, for example using `sf` package.

```{r}
jahres <- jahres |>
  subset(!is.na(lon)) |>
  sf::st_as_sf(coords = c("lon", "lat"), crs = "EPSG:4326")
```

Now it's quite easy to run any spatial analysis like distribution, or density. Let's look on distribution of Malva's:

```{r}
jahres |>
  subset(grepl("Malva", accepted_name)) |>
  subset(select = c("accepted_name", "geometry")) |>
  terra::plot()
```

### How to participate

The source files, divided by years, are located in the **source** directory. Entries are provided as data.frame structure, like:

```{r eval=FALSE}
jahres <- data.frame(
  species = "Cystopteris fragilis",
  citation = "@schalowErgebnisseDurchforschungSchlesischen1934",
  entry = "Cystopteris fragilis Naumburg a. B.: Schloßpark (Tscheppe)!; [...]",
  lon = 15.24453, 
  lat = 51.80259,
  comments = "Nowogród Bobrzański, park zamkowy (Wzgórze Zamkowe)"
) |> rbind(jahres)
```

Bibliography is provided as `bibentry` using `RefManageR` package

```{r eval=FALSE}
bib <- RefManageR::as.BibEntry(
  c(
    bibtype = "article",
    key  = "schalowErgebnisseDurchforschungSchlesischen1934",
    author = "Emil Schalow",
    title = "Ergebnisse der Durchforschung der schlesischen Gefässpflanzenwelt im Jahre 1933",
    journal = "Jahres-Bericht der Schlesischen Gesellschaft für vaterländische Cultur. 1933, Jg.106",
    date = "1934",
    volume = "106", 
    pages = "140--156")
)
```

There is additional file, `accepted_names.R`, located in `source/` folder, which provides the normalization of the species names provided by authors to common, accepted names of species, like:

```{r}
#| eval: false
#| 
an <- c(
  "Abutilon avicennae", "Abutilon theophrasti Medik.",
  "Acer campestre", "Acer campestre L.", 
  [...]
```

Feel free to spot an error or add missing data. If you recognize some locations where geographical coordinates are missing -- please add.